on:
  push:
    branch: [main]

name: ci

jobs:
  build-api:
    name: build-api
    runs-on: ubuntu-latest

    steps:
    - name: Checkout
      uses: actions/checkout@v2

    - name: Build, tag, and push image to Docker Hub
      id: build-image
      run: |
        cd api
        docker login --username=amiradar --password=amiradar123
        docker build -t amiradar/tiny-url.api .
        docker push amiradar/tiny-url.api
        
  build-url-service:
    name: build-url-service
    runs-on: ubuntu-latest

    steps:
    - name: Checkout
      uses: actions/checkout@v2

    - name: Build, tag, and push image to Docker Hub
      id: build-image
      run: |
        cd api
        docker login --username=amiradar --password=amiradar123
        docker build -t amiradar/tiny-url.url-service .
        docker push amiradar/tiny-url.url-service
